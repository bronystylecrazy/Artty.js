import t from"hyperactiv";const e=(t,e={attrs:{},on:{}},r)=>void 0===t?null:Array.isArray(e)?{tag:t,opts:{attrs:{},on:{}},children:e.flat()}:{tag:t,opts:e,children:r.flat()},r=t=>"string"==typeof t?document.createTextNode(t):s(t),s=t=>{const e=document.createElement(t.tag);for(var[s,n]of Object.entries(null==t||null==(i=t.opts)?void 0:i.attrs)){var i;e.setAttribute(s,n)}for(var o of t.children)if(null!==o){const t=r(o);e.appendChild(t)}return e},n=(t,e)=>{const r=[];for(var s=0;s<Math.min(t.length,e.length);s++)r.push([t[s],e[s]]);return r},i=(t,e)=>{if(void 0===e)return t=>{t.remove()};if("string"==typeof t||"string"==typeof e)return t!==e?t=>{const s=r(e);return t.replaceWith(s),s}:t=>{};if(t.tagName!==e.tagName)return t=>{const s=r(e);return t.replaceWith(s),s};const s=((t,e,r)=>{const s=[];for(const[t,e]of Object.entries(r))s.push(r=>{try{r.setAttribute(t,e)}catch(t){}return r});for(const t in e)t in e||s.push(e=>(e.removeAttribute(t),e));return t=>{for(var e of s)e(t)}})(0,t.opts.attrs,e.opts.attrs),o=((t,e)=>{const s=[],o=[],l=[];for(var[a,u]of n(t,e))s.push(i(a,u));if(t.length<e.length)for(const s of e.slice(t.length))o.push(t=>{const e=r(s);return t.appendChild(e),t});else for(var h=0;h<Math.abs(e.length-t.length);h++)l.push(t=>(t.removeChild(t.lastChild),t));return t=>{for(const[e,r]of n(s,t.childNodes))e(r);for(const e of o)e(t);for(const e of l)e(t);return t}})(t.children,e.children);return t=>(s(t),o(t),t)},o=(t,e={})=>{const r={};var s=[];for(var n of t.childNodes)n.nodeType!==Node.TEXT_NODE&&n.hasAttribute("(else)")||s.push(a(n,r));return`[${s.join(",")}]`},l=(t,e={})=>void 0===t||"null"==typeof t?"h()":`h('${t.tagName}',${p(t,e)},${o(t,e)})`,a=(t,e={})=>void 0===t?l():t.nodeType===Node.TEXT_NODE?u(t.textContent,e):((t,e={})=>{if(t.hasAttribute("(for)")){var r=t.getAttribute("(for)");if(t.removeAttribute("(for)"),!r.includes(" in "))return`__.l((${h(r.trim(),e)}), () => ${a(t,e)})`;var[s,n]=r.split(" in ");return s=s.trim(),`__.l((${h(n,e)}), (${s}) => ${a(t,e)})`}if(t.hasAttribute("(if)")){r=t.getAttribute("(if)"),t.removeAttribute("(if)");var i=t.nextElementSibling;return null!==i&&i.hasAttribute("(else)")?(i.setAttribute("data-elsed",!0),`((${h(r,e)}) ? ${a(t,e)} : ${a(i,e)})`):`((${h(r,e)}) ? ${a(t,e)} : ${a()})`}return l(t,e)})(t,e),u=(t,e={})=>{var r=t.replaceAll("\n","\\n"),s=[],n="",i=[];for(var o of r.split(""))"{"===o?(i.push("{"),i.length>0&&(s.push(n),n="{")):"}"===o?(i.pop(),i.length<=0&&(s.push(n+o),n="")):n+=o;return s.push(n),f(s.filter(t=>""!==t),e)},h=(t,e={})=>{var r=t||"",s=r.matchAll(/([a-zA-Z_$.][a-zA-Z_$0-9.]*)/gim);if(null===s)return r;for(let t of s){var n=t[0],i=t.index;void 0===window[n.split(".")[0]||t]&&(r=r.substring(0,i)+r.substring(i).replace(n.split(".")[0],`(_.${n.split(".")[0]} || ${n.split(".")[0]})`))}return r},f=(t,e={})=>t.map(t=>{let r="";return t.startsWith("{")&&t.endsWith("}")?(r=t.slice(1,t.length-1).trim(),`__.s(${h(r,e)})`):`"${t}"`}).join(","),p=(t,e={})=>{var r=[];if(t.attributes.length>0)for(var{name:s,value:n}of t.attributes)s.includes(":")?r.push(`'${s.slice(1)}': ${h(n,e)}`):r.push(`'${s}': '${n}'`);return`{ attrs: {${r.join(",")}}}`},{observe:c}=t,d=t=>({state:c(t),vnodes:[],template:"",$el:null,updateList:[],sync(t){this.$el=document.querySelector(t),this.template=`return h('div',${o(this.$el)})`;const[s,n]=[this.state,this.utils];let l=new Function("h","_","__",this.template)(e,s,n),a=r(l),u=this.mount(a,this.$el);return this.state.__handler=(t,r,s,n)=>{const[o,a]=[this.state,this.utils];let h=new Function("h","_","__",this.template)(e,o,a);const f=i(l,h);u=f(u),l=h,this.vnodes=l},this},update(){for(var t of this.updateList)t(this.state);this.$el.removeAttribute("(cloak)")},render(t){},nextTick(t){this.updateList.push(t)},mount:(t,e)=>(e.replaceWith(t),t),utils:{l(t,e){var r=[];return"number"==typeof t&&Array.from(Array(t).keys()).forEach((t,s)=>r.push(e(s,s))),Array.isArray(t)&&t.forEach((t,s)=>r.push(e(t,s))),r},s:t=>void 0===t?"":"object"==typeof t?JSON.stringify(t):String(t)}});export{d as default};
//# sourceMappingURL=artty.js.modern.js.map
